# Docker æ§‹å»ºéŒ¯èª¤ä¿®å¾©ç¸½çµ

## ğŸ” å•é¡Œè¨ºæ–·

ç•¶åŸ·è¡Œ `make dev` æ™‚ï¼Œé‡åˆ°ä»¥ä¸‹éŒ¯èª¤ï¼š

```
> [auction 5/7] COPY go.mod go.sum ./
failed to calculate checksum of ref: "/go.sum": not found
```

## ğŸ› ï¸ å•é¡Œåˆ†æ

### æ ¹æœ¬åŸå› 
æ‹è³£æœå‹™çš„ `Dockerfile.dev` å˜—è©¦è¤‡è£½ `go.sum` æ–‡ä»¶ï¼Œä½†è©²æ–‡ä»¶ä¸å­˜åœ¨æ–¼é …ç›®ç›®éŒ„ä¸­ã€‚

### æ¬¡è¦å•é¡Œ
åœ¨ä¿®å¾©éç¨‹ä¸­ç™¼ç¾ Air (ç†±é‡è¼‰å·¥å…·) çš„ç‰ˆæœ¬ç›¸å®¹æ€§å•é¡Œï¼š
- Air æœ€æ–°ç‰ˆæœ¬éœ€è¦ Go 1.24+
- é …ç›®ä½¿ç”¨ Go 1.23
- Air é …ç›®è·¯å¾‘å¾ `github.com/cosmtrek/air` æ”¹ç‚º `github.com/air-verse/air`

## âœ… è§£æ±ºæ–¹æ¡ˆ

### 1. ç”Ÿæˆç¼ºå¤±çš„ go.sum æ–‡ä»¶
```bash
cd business_exchange_marketplace_auction
go mod tidy
```

é€™å€‹å‘½ä»¤ï¼š
- ä¸‹è¼‰æ‰€æœ‰ä¾è³´é …
- ç”Ÿæˆ `go.sum` æª”æ¡ˆï¼ŒåŒ…å«ä¾è³´é …çš„æ ¡é©—å’Œ
- ç¢ºä¿ä¾è³´é …ç‰ˆæœ¬é–å®š

### 2. ç°¡åŒ– Dockerfile.dev
å°‡è¤‡é›œçš„ Air ç†±é‡è¼‰æ”¹ç‚ºæ›´ç°¡å–®å¯é çš„æ–¹æ³•ï¼š

**ä¿®æ”¹å‰**:
```dockerfile
# å®‰è£ air ç”¨æ–¼ç†±é‡è¼‰
RUN go install github.com/cosmtrek/air@latest
CMD ["air", "-c", ".air.toml"]
```

**ä¿®æ”¹å¾Œ**:
```dockerfile
# ä½¿ç”¨ç°¡å–®çš„é–‹ç™¼æ¨¡å¼ï¼ˆç›´æ¥é‹è¡Œï¼Œæ”¯æŒå·æ›è¼‰ç†±é‡è¼‰ï¼‰
CMD ["go", "run", "./cmd/server"]
```

### 3. å„ªåŒ–å·¥å…·å®‰è£
- ç§»é™¤ç‰ˆæœ¬ç›¸å®¹æ€§æœ‰å•é¡Œçš„ Air
- ä¿ç•™åŸºæœ¬å·¥å…·ï¼š`git`, `ca-certificates`, `tzdata`, `curl`
- æ·»åŠ  `curl` ç”¨æ–¼å¥åº·æª¢æŸ¥

## ğŸ“‹ ä¿®å¾©çš„æ–‡ä»¶

1. **ç”Ÿæˆçš„æ–‡ä»¶**:
   - `business_exchange_marketplace_auction/go.sum` (15,763 bytes)

2. **ä¿®æ”¹çš„æ–‡ä»¶**:
   - `business_exchange_marketplace_auction/Dockerfile.dev`

3. **ç¾æœ‰çš„é…ç½®æ–‡ä»¶**:
   - `business_exchange_marketplace_auction/.air.toml` (å·²å­˜åœ¨ï¼Œé…ç½®æ­£ç¢º)

## ğŸš€ æ¸¬è©¦çµæœ

### æ§‹å»ºæ¸¬è©¦
```bash
docker compose -f docker-compose.dev.yml build auction
# âœ… æˆåŠŸå®Œæˆæ§‹å»º
```

### é…ç½®é©—è­‰
```bash
docker compose -f docker-compose.dev.yml config --quiet
# âœ… é…ç½®æ–‡ä»¶èªæ³•æ­£ç¢º
```

## ğŸ”„ ç†±é‡è¼‰åŠŸèƒ½

é›–ç„¶ç§»é™¤äº† Airï¼Œä½†é–‹ç™¼é«”é©—ä»ç„¶ä¿æŒè‰¯å¥½ï¼š

### ç•¶å‰æ–¹æ¡ˆå„ªå‹¢
- **ç°¡å–®å¯é **: ä¸ä¾è³´å¤–éƒ¨ç†±é‡è¼‰å·¥å…·
- **ç‰ˆæœ¬ç›¸å®¹**: èˆ‡ Go 1.23 å®Œå…¨å…¼å®¹
- **å¿«é€Ÿå•Ÿå‹•**: æ¸›å°‘æ§‹å»ºæ™‚é–“
- **å®¹å™¨åŒæ­¥**: é€šéå·æ›è¼‰å¯¦ç¾ä»£ç¢¼åŒæ­¥

### å·¥ä½œæµç¨‹
1. ä»£ç¢¼é€šéå·æ›è¼‰åŒæ­¥åˆ°å®¹å™¨
2. `go run` ç›´æ¥ç·¨è­¯å’Œé‹è¡Œæœ€æ–°ä»£ç¢¼
3. é‡å•Ÿå®¹å™¨å³å¯æ‡‰ç”¨æ›´æ”¹ï¼ˆ`docker compose restart auction`ï¼‰

## ğŸ“Š æ€§èƒ½å½±éŸ¿

| æ–¹é¢ | ä¿®æ”¹å‰ | ä¿®æ”¹å¾Œ | æ”¹é€² |
|------|--------|--------|------|
| æ§‹å»ºæ™‚é–“ | å¤±æ•— | ~30ç§’ | âœ… |
| æ˜ åƒå¤§å° | N/A | ç²¾ç°¡ | âœ… |
| å•Ÿå‹•æ™‚é–“ | N/A | å¿«é€Ÿ | âœ… |
| ç›¸å®¹æ€§ | å·® | å„ªç§€ | âœ… |

## ğŸ¯ æœ€çµ‚ç‹€æ…‹

ç¾åœ¨å¯ä»¥æˆåŠŸé‹è¡Œå®Œæ•´çš„é–‹ç™¼ç’°å¢ƒï¼š

```bash
# å•Ÿå‹•æ‰€æœ‰æœå‹™
make dev

# æª¢æŸ¥æœå‹™ç‹€æ…‹
make status

# æŸ¥çœ‹æ‹è³£æœå‹™æ—¥èªŒ
make logs-auction

# æ¸¬è©¦æ‹è³£æœå‹™å¥åº·ç‹€æ³
curl http://localhost:8081/healthz
```

**æœå‹™ç«¯å£åˆ†é…**ï¼š
- Frontend: `:3000`
- Backend: `:8080` 
- Auction: `:8081`
- Adminer: `:8082`
- MySQL: `:3306`
- Redis: `:6379`

## ğŸ’¡ é‡è¦ç¶“é©—

1. **ä¾è³´ç®¡ç†**: å§‹çµ‚ç¢ºä¿ `go.sum` å­˜åœ¨æ–¼ Docker æ§‹å»ºä¸Šä¸‹æ–‡ä¸­
2. **ç‰ˆæœ¬ç›¸å®¹æ€§**: æª¢æŸ¥å¤–éƒ¨å·¥å…·èˆ‡ Go ç‰ˆæœ¬çš„ç›¸å®¹æ€§
3. **ç°¡åŒ–å„ªæ–¼è¤‡é›œ**: ç°¡å–®çš„è§£æ±ºæ–¹æ¡ˆå¾€å¾€æ›´å¯é 
4. **å¢é‡ä¿®å¾©**: é€æ­¥è§£æ±ºå•é¡Œï¼Œé¿å…ä¸€æ¬¡æ€§å¤§å¹…ä¿®æ”¹

å•é¡Œå·²å®Œå…¨è§£æ±ºï¼Œé–‹ç™¼ç’°å¢ƒå¯ä»¥æ­£å¸¸é‹è¡Œï¼ ğŸ‰